name: Validar Ejercicio Completo

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Mod scripts
      - name: Modificar scripts
        run: chmod +x scripts/*.sh

      # Step 2: Checkout the code
      - name: Chequear el código
        run: ./scripts/checkout_code.sh

      # Step 3: Analyze the PR description
      - name: Analizar descripción del PR
        run: ./scripts/analyze_pr_description.sh

      # Step 4: Validate exercises
      - name: Validar ejercicios seleccionados
        run: ./scripts/validate_exercises.sh

      # Step 5: Close the PR if there are validation errors
      - name: Cerrar PR si hay errores
        if: failure() # This checks if any previous step has failed
        run: ./scripts/close_pr.sh true # Pass 'true' to indicate that the PR should be closed
